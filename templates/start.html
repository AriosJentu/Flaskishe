<head>
	<title>База данных</title>
	<!--script type="text/javascript" src="../static/script/jquery.js"></script-->
	<link rel="stylesheet" href="../static/css/style.css">
</head>

<body>
	<center>

		<form name="Bases" action="/" method='POST'>
			
			<!--<table>
				<tr>
				{% for item in items %}
					<th><a href="/table/{{ item }}">{{ item }}</a></th>
				{% endfor %}
				</tr>
			</table>-->
			<font size=3>
				<table>
					<tr>
						Таблица: 
						<select name="List">
							{% for item in items %}
								{% if item == selected %}
									<option value="{{ item }}" SELECTED>{{ item }}</option>
								{% else %}
									<option value="{{ item }}">{{ item }}</option>
								{% endif %}
							{% endfor %}
						</select>
					</tr>
					<tr>
							Оператор: 
							<select name="MrgType">
								{% for mrg in mrg_list.keys() %}
									{% if mrg == mrg_id %}
										<option value="{{ mrg }}" SELECTED>{{ mrg }}</option>
									{% else %}
										<option value="{{ mrg }}">{{ mrg }}</option>
									{% endif %}
								{% endfor %}
							</select>
					</tr>
					<tr>
						Количество элементов на страницу:
						<select name="PageSize">
							{% for size in pglist %}
								{% if size == cursize %}
									<option value="{{ size }}" SELECTED>{{ size }}</option>
								{% else %}
									<option value="{{ size }}">{{ size }}</option>
								{% endif %}
							{% endfor %}
						</select>
					</tr>
				</table>
			</font>
			<button name="go" type="submit">Перейти</button>
			<p></p>

			<p>Запросы:</p>
			<table>

					<tr>
						<button name="plus" type="submit">+</button>
					</tr>
					{% if qcnt > 1 %}
						<tr>
							<button name="minus" type="submit">-</button>
						</tr>
					{% endif %}
			</table>
			<table>
				{% for i in range(qcnt) %}	
					<tr>

						<td>
							<select name="QueryColumn{{ i|safe }}">
								{% for title in qsel %}
									{% if i < qlen and title in queries[i].name %}
										<option value="{{ title }}" SELECTED>{{ title }}</option>
									{% else %}
										<option value="{{ title }}">{{ title }}</option>
									{% endif %}
								{% endfor %}
							</select>
						</td>
						<td>
							<select name="QueryCmp{{ i|safe }}">
								{% for cmp in cmp_list %}
									{% if i < qlen and queries[i].cmp == cmp %}
										<option value="{{ cmp }}" SELECTED>{{ cmp }}</option>
									{% else %}
										<option value="{{ cmp }}">{{ cmp }}</option>
									{% endif %}
								{% endfor %}
							</select>
						</td>

						<td>
							<input name="QueryIn{{ i|safe }}" value=
								{% if i < qlen %}
									"{{queries[i].value}}"
								{% else %}
									""
								{% endif %}
							/>
						</td>

					</tr>

				{% endfor %}
			</table>


			<button name="go" type="submit">Составить запрос</button>

			<p>
			</p>

			<table>
				<col width="20%">
				
				{% if editmode %}
					<tr>
						<td align="right">
							<button name="ModeChanger" type="submit">Выйти из режима редактирования</button>
						</td>
					</tr>
					<tr>
						<td align="right">
							<button name="AddRecord" type="submit">Добавить запись</button>
						</td>
					</tr>
				{% else %}
					<tr>
						<td align="right">
							<button name="ModeChanger" type="submit">Перейти в режим редактирования</button>
						</td>
					</tr>
				{% endif %}

			</table>

			{% if name %}
				<h1>Запрос {{ name }}</h1>
				<h5>Страница {{ curpg }}</h5>
				<table id="tab">

					{% for width in widthes%}
						<col width="{{ width }}">
					{% endfor %}

					{% if editmode %}
						<col width="125">
					{% endif %}

					<tr id="elem">
					{% for title in heading %}
						<th id="elem">
							<p align="center">
								<button name="Title{{ title }}" type="submit">{{ title }}</button>
							</p>
						</th>
					{% endfor %}	
					{% if editmode %}
						<th id="elem">
							<p align="center">
								Редактор
							</p>
						</th>
					{% endif %}
					</tr>

					{% for items in range(table|length) %}
						<tr id="elem">
							{% for item in range(table[items]|length) %}
								{% if editmode and table[items] in edited %}
									<td id="elem">
										<p align="center"><b>
											Текущее значение:
										</b></p>
										<p><i>
											{{ table[items][item]|safe }} 
										</i></p>
										<p align="center"><b>
											Чистое значение:
										</b></p>
										<p><i>
											<b>`{{ tabdef[items][item]|safe }}`</b>
										</i></p>
										<p align="center"><b>
											Введите новое значение:
										</b></p>
										<p>
											<input name="Changing{{ table[items]|safe }}Column{{ item|safe }}" value="{{ tabdef[items][item]|safe }}"/>
										</p>
									</td>
								{% else %}
									<td id="elem">
										{{ table[items][item]|safe }}
									</td>
								{% endif %}

							{% endfor %}

							{% if editmode %}
								<td id="elem">
									<button name="Edit{{table[items]}}" type="submit"><font size="6">
									{% if table[items] in edited %}
										✓
									{% else %}
										✎
									{% endif %}
									</font></button>
									<button name="Delete{{table[items]}}" type="submit"><font size="6">
									{% if table[items] in edited %}
										⟲
									{% else %}
										⨯
									{% endif %}
									</font></button>
								</td>
							{% endif %}
						</tr>
					{% endfor %}
				</table>
			{% else %}
				<h1>Данная страница пуста</h1>
			{% endif %}

			<h6>{{ low }}-{{ high }} из {{ tabsize }}</h6>

			<table>
				{% for i in range(1, count+1) %}
				<tr>
					<a href="/?table={{ selected|safe }}&count={{ cursize|safe }}&page={{ i|safe }}&query={{curquery|safe}}&mrg={{ mrg_list[mrg_id]|safe }}&edit={{ editmode|safe }}"> {{ i|safe }} </a>
				</tr>
				{% endfor %}
			</table>

		</form>

	</center>
</body>
